

## 4.3.3 Activity Diagrams (Textual Specification)

This subsection describes the activity flows of key system operations. The descriptions below are intended to guide the construction of activity diagrams and reflect actual system behavior.

---

### Activity Diagram: User Login

1. Start
2. User enters phone number and password
3. System validates credentials
4. Decision: credentials valid?
    - No: display error message and end
    - Yes: load user role and tenant context
5. Redirect user to role-specific dashboard
6. End

---

### Activity Diagram: Sale and Order Creation

1. Start
2. Cashier accesses the Sale module
3. Decision: is a cash session required by policy?
    - Yes: check for active cash session
        - No active session: prompt user to start cash session
4. Cashier adds menu items to cart
5. Cashier selects sale type (dine-in, take-away, delivery)
6. System calculates subtotal, discounts, VAT, and grand total
7. Cashier selects payment method
8. Cashier confirms checkout
9. System finalizes sale
10. System creates order with status = in-prep
11. System generates eReceipt
12. End

---

### Activity Diagram: Order Status Update

1. Start
2. User selects an existing order
3. System checks current order status
4. User updates order status
    - in-prep → ready
    - ready → delivered
5. System saves updated status
6. End

---

### Activity Diagram: Sale Void Request and Approval

1. Start
2. Cashier selects a finalized order
3. Cashier submits a void request
4. System updates sale status to void-pending
5. Manager or Admin reviews void request
6. Decision: void approved?
    - Yes: system reverses sale and inventory changes, status set to voided
    - No: system restores sale status to finalized
7. End

---

### Activity Diagram: Inventory Deduction

1. Start
2. Sale is finalized
3. System checks inventory deduction policy
4. If enabled, system deducts stock using journal records
5. Update branch inventory levels
6. End

---

### Activity Diagram: Cash Session Lifecycle

1. Start
2. User starts cash session
3. User inputs opening cash amount
4. Perform sales transactions
5. Record paid-in or paid-out actions if permitted
6. User closes cash session
7. User inputs counted cash amount
8. System calculates cash variance
9. End